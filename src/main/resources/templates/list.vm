<html>
<head>
    <title>Epic DashBoards</title>
    <meta name="decorator" content="atl.general">
    <script>
        AJS.$(document).ready(function() {
            jQuery('.delete-issue').click(function() {
                console.log('deleting');
                var self = jQuery(this);
                jQuery.ajax({
                    type: "delete",
                    url: "issuecrud?key=" + self.data("key"),
                    success: function(data) {
                        console.log('dom', self, data);
                        self.parent().parent().remove();
                    },
                    error: function() {
                        console.log('error', arguments);
                    }
                });
                return false;
            });
        });
    </script>
</head>
<body class="page-type-admin">
<div class="content-container">

    <div class="content-body">
        <header>
        <h1>
        #if($issues.size()==0)
            No Epics created.
        #else
            Epic List
        #end</h1>
        </header>

        #if ($issues.size() > 0)
            <div class="issues">
                <table class="aui">
                    <thead>
                    <tr>
                        <th>Key</th>
                        <th>Summary</th>
                        <th>Total Story Points</th>
                        <th>Burned Story Points</th>
                        <th>Total Complete</th>
                    </tr>
                    </thead>
                    <tbody>
                        #foreach( $issue in $issues )
                        <tr>
                            <td>
                                <a class="lozenge" href="/jira/secure/IssueNavigator.jspa?reset=true&amp;jqlQuery=cf%5B$cfEpic%5D+%3D+$issue.getKey()" title="$issue.getKey()"><span>$issue.getKey()</span></a>
                            </td>
                            <td>
                                $issue.getSummary()
                            </td>
                            <td>
                                $issue.getTotalStoryPoints()
                            </td>
                            <td>
                                $issue.getBurnedStoryPoints()
                            </td>
                            <td>
                                $issue.getPercentComplete() %
                            </td>
                            <td>
                                #set($im = $issue.getImageMap())
                                #set($imagemapWithHtml = $issue.getImageMap())
                                #if ( "$!im" != "" )
                                $imagemapWithHtml
                                <img src='/jira/charts?filename=$issue.getChartName()' border='0' usemap="\#$issue.getImageMapName()" />
                                #end
                            </td>
                        </tr>
                        #end
                    </tbody>
                </table>
                <p>Total SP: <strong>$totalStoryPoints</strong></p>
                <p>Burned SP: <strong>$burnedStoryPoints</strong></p>
            </div>
        #end
    </div>
</div>
</body>
</html>